<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.108.0">
    <meta name="description" content="Overwatch Documentation">
<meta name="author" content="Daniel Tomes -- DatabricksLabs">

    <link rel="icon" href="https://databrickslabs.github.io/overwatch/images/favicon.png" type="image/png">

    <title>CustomCosts :: Overwatch</title>

    
    <link href="https://databrickslabs.github.io/overwatch/css/nucleus.css?1670967396" rel="stylesheet">
    <link href="https://databrickslabs.github.io/overwatch/css/fontawesome-all.min.css?1670967396" rel="stylesheet">
    <link href="https://databrickslabs.github.io/overwatch/css/hybrid.css?1670967396" rel="stylesheet">
    <link href="https://databrickslabs.github.io/overwatch/css/featherlight.min.css?1670967396" rel="stylesheet">
    <link href="https://databrickslabs.github.io/overwatch/css/perfect-scrollbar.min.css?1670967396" rel="stylesheet">
    <link href="https://databrickslabs.github.io/overwatch/css/auto-complete.css?1670967396" rel="stylesheet">
    <link href="https://databrickslabs.github.io/overwatch/css/atom-one-dark-reasonable.css?1670967396" rel="stylesheet">
    <link href="https://databrickslabs.github.io/overwatch/css/theme.css?1670967396" rel="stylesheet">
    <link href="https://databrickslabs.github.io/overwatch/css/hugo-theme.css?1670967396" rel="stylesheet">
    
    <link href="https://databrickslabs.github.io/overwatch/css/theme-blue.css?1670967396" rel="stylesheet">
    
    

    <script src="https://databrickslabs.github.io/overwatch/js/jquery-3.3.1.min.js?1670967396"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    

<script async defer src="https://buttons.github.io/buttons.js"></script>
  </head>
  <body class="" data-url="https://databrickslabs.github.io/overwatch/deployoverwatch/configureoverwatch/customcosts/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://databrickslabs.github.io/overwatch/">
    <img src="https://databrickslabs.github.io/overwatch/images/tmp_logo4.png", width="85%">
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="https://databrickslabs.github.io/overwatch/js/lunr.min.js?1670967396"></script>
<script type="text/javascript" src="https://databrickslabs.github.io/overwatch/js/auto-complete.js?1670967396"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/databrickslabs.github.io\/overwatch\/";
    
</script>
<script type="text/javascript" src="https://databrickslabs.github.io/overwatch/js/search.js?1670967396"></script>

    
  </div>
  
  <section id="homelinks">
    <ul>
      <li>
        <a class="padding" href='https://databrickslabs.github.io/overwatch/'><i class='fas fa-home'></i> Home</a>
      </li>
    </ul>
  </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/deployoverwatch/" title="Deploy Overwatch" class="dd-item
        parent
        
        
        ">
      <a href="https://databrickslabs.github.io/overwatch/deployoverwatch/">
          Deploy Overwatch
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/deployoverwatch/configureoverwatch/" title="Configure Overwatch" class="dd-item
        parent
        
        
        ">
      <a href="https://databrickslabs.github.io/overwatch/deployoverwatch/configureoverwatch/">
          Configure Overwatch
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/deployoverwatch/configureoverwatch/customcosts/" title="CustomCosts" class="dd-item active">
        <a href="https://databrickslabs.github.io/overwatch/deployoverwatch/configureoverwatch/customcosts/">
        CustomCosts
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/deployoverwatch/configureoverwatch/securityconsiderations/" title="Security Considerations" class="dd-item ">
        <a href="https://databrickslabs.github.io/overwatch/deployoverwatch/configureoverwatch/securityconsiderations/">
        Security Considerations
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/dataengineer/" title="Data Engineering" class="dd-item
        
        
        
        ">
      <a href="https://databrickslabs.github.io/overwatch/dataengineer/">
          Data Engineering
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/dataengineer/definitions/" title="Data Dictionary (Latest)" class="dd-item
        
        
        
        ">
      <a href="https://databrickslabs.github.io/overwatch/dataengineer/definitions/">
          Data Dictionary (Latest)
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/dataengineer/definitions/061x/" title="Data Dictionary - 0.6.1.x" class="dd-item ">
        <a href="https://databrickslabs.github.io/overwatch/dataengineer/definitions/061x/">
        Data Dictionary - 0.6.1.x
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dataengineer/pipeline_management/" title="Pipeline_Management" class="dd-item ">
        <a href="https://databrickslabs.github.io/overwatch/dataengineer/pipeline_management/">
        Pipeline_Management
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dataengineer/upgrade/" title="Upgrade" class="dd-item ">
        <a href="https://databrickslabs.github.io/overwatch/dataengineer/upgrade/">
        Upgrade
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dataengineer/productionizing/" title="Productionizing" class="dd-item ">
        <a href="https://databrickslabs.github.io/overwatch/dataengineer/productionizing/">
        Productionizing
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/changelog/" title="ChangeLog" class="dd-item
        
        
        
        ">
      <a href="https://databrickslabs.github.io/overwatch/changelog/">
          ChangeLog
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/faq/" title="FAQ" class="dd-item
        
        
        
        ">
      <a href="https://databrickslabs.github.io/overwatch/faq/">
          FAQ
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/troubleshooting/" title="Troubleshooting" class="dd-item
        
        
        
        ">
      <a href="https://databrickslabs.github.io/overwatch/troubleshooting/">
          Troubleshooting
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/deployment/" title="Deployment" class="dd-item ">
        <a href="https://databrickslabs.github.io/overwatch/troubleshooting/deployment/">
        Deployment
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/pipeline/" title="Pipeline" class="dd-item ">
        <a href="https://databrickslabs.github.io/overwatch/troubleshooting/pipeline/">
        Pipeline
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/troubleshooting/deploymentlegacy/" title="Deployment (Legacy)" class="dd-item ">
        <a href="https://databrickslabs.github.io/overwatch/troubleshooting/deploymentlegacy/">
        Deployment (Legacy)
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/contributing/" title="" class="dd-item
        
        
        
        ">
      <a href="https://databrickslabs.github.io/overwatch/contributing/">
          
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      <center>

    
    <a class="github-button" href="https://github.com/databrickslabs/overwatch/subscription"
       data-icon="octicon-eye" data-show-count="true" aria-label="Watch Overwatch on GitHub">Watch</a>


    <a class="github-button" href="https://github.com/databrickslabs/overwatch" data-icon="octicon-star" data-show-count="true" aria-label="Star databrickslabs/overwatch on GitHub">Star</a>


    <a class="github-button" href="https://github.com/databrickslabs/overwatch/fork"
       data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork Overwatch on GitHub">Fork</a>

    <p>A <a href="https://github.com/databrickslabs">Databricks Labs</a> project.</p>
</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='https://databrickslabs.github.io/overwatch/'>Welcome To OverWatch</a> > <a href='https://databrickslabs.github.io/overwatch/deployoverwatch/'>Deploy Overwatch</a> > <a href='https://databrickslabs.github.io/overwatch/deployoverwatch/configureoverwatch/'>Configure Overwatch</a> > CustomCosts
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#configuring-custom-costs">Configuring Custom Costs</a></li>
      </ul>
    </li>
    <li><a href="#compute-costs-are-estimated">Compute Costs Are Estimated</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              CustomCosts
            </h1>
          

        


<h3 id="configuring-custom-costs">Configuring Custom Costs</h3>
<p>There are three essential components to the cost function:</p>
<ul>
<li>The node type (instanceDetails.Api_Name) and its associated contract price (instanceDetails.Compute_Contract_Price)</li>
<li>The node type (instanceDetails.Api_Name) and its associated DBUs per hour (instanceDetails.Hourly_DBUs)</li>
<li>The DBU contract prices for the SKU under which your DBUs are charged such as:
<ul>
<li>Interactive</li>
<li>Automated</li>
<li>DatabricksSQL
<ul>
<li>Databricks currently has 3 SKUs (classic/pro/serverless) but Overwatch is not able to accurately report
on DBSQL pricing at this time due to data not available in the Databricks Product. When this data becomes
available, Overwatch will integrate it and enable DBSQL cost tracking.</li>
</ul>
</li>
<li>JobsLight</li>
</ul>
</li>
</ul>
<p>The DBU contract costs are captured from the
<a href="https://databrickslabs.github.io/overwatch/#databrickscontractprices">Overwatch Configuration</a> maintained
as a slow-changing-dimension in the <a href="https://databrickslabs.github.io/overwatch/dataengineer/definitions//#dbucostdetails">dbuCostDetails table</a>.
The compute costs and dbu to node
associations are maintained as a slow-changing-dimension in the
<a href="https://databrickslabs.github.io/overwatch/dataengineer/definitions//#instancedetails">instanceDetails</a> table.</p>
<ul>
<li><strong>IMPORTANT</strong> These tables are automatically created in the dataTarget upon first initialization of the pipeline.</li>
<li><strong>DO NOT</strong> try to manually create the target database outside of Overwatch as that will lead to database validation errors.</li>
<li><strong>INSTANCE DETAILS IS NOT MAINTAINED BY THE OVERWATCH PIPELINE</strong> After the first run, this table will not be edited
by the Overwatch Pipeline again. Customers often update the compute_contract_price to reflect their contract prices
with the cloud vendor. Updating this table would override these customizations. If you are using instance types
that are not present in instanceDetails table you will see $0 costs. Be sure to periodically add new node types.</li>
</ul>
<p><strong>To customize costs</strong> configure and complete your first Bronze run. Before running Silver/Gold, alter the
instanceDetails table to your satisfaction. Note that this is only true for instanceDetails not dbuCostDetails as
Overwatch will maintain this table for you.</p>
<p>Note that each subsequent workspace referencing the same dataTarget will append default compute prices to instanceDetails
table if no data is present for that organization_id (i.e. workspace).
If you would like to customize compute costs for all workspaces,<br>
export the instanceDetails dataset to external editor (after first init), add the required metrics referenced above
for each workspace, and update the target table with the customized cost information. Note that the instanceDetails
object in the consumer database is just a view so you must edit/overwrite the underlying table in the ETL database. The view
will automatically be recreated upon first pipeline run.</p>
<p><strong>IMPORTANT</strong> These cost lookup tables are slow-changing-dimensions and thus they have specific rule requirements;
familiarize yourself with the details at the links below. If the rules fail, the Gold Pipeline will fail with specific
costing errors to help you resolve it.</p>
<ul>
<li><a href="https://databrickslabs.github.io/overwatch/dataengineer/definitions//#instancedetails">InstanceDetails Table Details</a></li>
<li><a href="https://databrickslabs.github.io/overwatch/dataengineer/definitions//#dbucostdetails">dbuCostDetails Table Details</a></li>
</ul>
<p><a href="https://azureprice.net/">Helpful Tool (AZURE_Only)</a> to get pricing by region by node.</p>
<p>Sample compute details available below. These are only meant for reference, they do not have all required fields.
Follow the instruction above for how to implement custom costs.


<a href="https://drive.google.com/file/d/1tj0GV-vX1Ka9cRcJpJSwkQx6bbpueSwl/view?usp=sharing" target="_blank">AWS Example</a>
 |


<a href="https://drive.google.com/file/d/13hYZrOAmzLwIjfgNz0YWx-qE2TdWe0-c/view?usp=sharing" target="_blank">Azure Example</a>
</p>
<h2 id="compute-costs-are-estimated">Compute Costs Are Estimated</h2>
<p>Overwatch is not able to determine the VM SKU provided by your cloud provider (i.e. OnDemand/Spot/Reserved); thus the
exact price of compute asset at the time of provisioning isn&rsquo;t available. The compute_contract_price configured in
<a href="https://databrickslabs.github.io/overwatch/dataengineer/definitions//#instancedetails">instanceDetails</a> is best configured as the
average price you received over some previous period to allow Overwatch to best estimate the compute costs;
nonetheless, the compute costs are just that, estimates.</p>


<footer class="footline">
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="https://databrickslabs.github.io/overwatch/deployoverwatch/configureoverwatch/" title="Configure Overwatch"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="https://databrickslabs.github.io/overwatch/deployoverwatch/configureoverwatch/securityconsiderations/" title="Security Considerations" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://databrickslabs.github.io/overwatch/js/clipboard.min.js?1670967396"></script>
    <script src="https://databrickslabs.github.io/overwatch/js/perfect-scrollbar.min.js?1670967396"></script>
    <script src="https://databrickslabs.github.io/overwatch/js/perfect-scrollbar.jquery.min.js?1670967396"></script>
    <script src="https://databrickslabs.github.io/overwatch/js/jquery.sticky.js?1670967396"></script>
    <script src="https://databrickslabs.github.io/overwatch/js/featherlight.min.js?1670967396"></script>
    <script src="https://databrickslabs.github.io/overwatch/js/highlight.pack.js?1670967396"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://databrickslabs.github.io/overwatch/js/modernizr.custom-3.6.0.js?1670967396"></script>
    <script src="https://databrickslabs.github.io/overwatch/js/learn.js?1670967396"></script>
    <script src="https://databrickslabs.github.io/overwatch/js/hugo-learn.js?1670967396"></script>

    <link href="https://databrickslabs.github.io/overwatch/mermaid/mermaid.css?1670967396" rel="stylesheet" />
    <script src="https://databrickslabs.github.io/overwatch/mermaid/mermaid.js?1670967396"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

