<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.76.5" />
    <meta name="description" content="Overwatch Documentation">
<meta name="author" content="Daniel Tomes -- DatabricksLabs">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Getting Started :: Overwatch</title>

    
    <link href="/css/nucleus.css?1603925781" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1603925781" rel="stylesheet">
    <link href="/css/hybrid.css?1603925781" rel="stylesheet">
    <link href="/css/featherlight.min.css?1603925781" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1603925781" rel="stylesheet">
    <link href="/css/auto-complete.css?1603925781" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1603925781" rel="stylesheet">
    <link href="/css/theme.css?1603925781" rel="stylesheet">
    <link href="/css/hugo-theme.css?1603925781" rel="stylesheet">
    
    <link href="/css/theme-blue.css?1603925781" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1603925781"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/userguide/getting-started/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://tomesdata.z20.web.core.windows.net/">
    <img src="/images/tmp_logo4.png", width="85%">
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1603925781"></script>
<script type="text/javascript" src="/js/auto-complete.js?1603925781"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/tomesdata.z20.web.core.windows.net\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1603925781"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/userguide/" title="UserGuide" class="dd-item 
        parent
        
        
        ">
      <a href="/userguide/">
          UserGuide
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/userguide/getting-started/" title="Getting Started" class="dd-item active">
        <a href="/userguide/getting-started/">
        Getting Started
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/configuration/" title="Configuration" class="dd-item ">
        <a href="/userguide/configuration/">
        Configuration
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/modules/" title="Modules" class="dd-item ">
        <a href="/userguide/modules/">
        Modules
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/advancedtopics/" title="Advanced Topics" class="dd-item ">
        <a href="/userguide/advancedtopics/">
        Advanced Topics
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/troubleshooting/" title="Troubleshooting" class="dd-item ">
        <a href="/userguide/troubleshooting/">
        Troubleshooting
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/upgrading/" title="Upgrading" class="dd-item ">
        <a href="/userguide/upgrading/">
        Upgrading
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/roadmap/" title="Roadmap" class="dd-item ">
        <a href="/userguide/roadmap/">
        Roadmap
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/environmentsetup/" title="EnvironmentSetup" class="dd-item 
        
        
        
        ">
      <a href="/environmentsetup/">
          EnvironmentSetup
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/environmentsetup/azure/" title="Azure" class="dd-item ">
        <a href="/environmentsetup/azure/">
        Azure
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/environmentsetup/aws/" title="AWS" class="dd-item ">
        <a href="/environmentsetup/aws/">
        AWS
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/contributing/" title="" class="dd-item 
        
        
        
        ">
      <a href="/contributing/">
          
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>A <a href="https://github.com/databrickslabs">Databricks Labs</a> project.</p>
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Welcome To OverWatch</a> > <a href='/userguide/'>UserGuide</a> > Getting Started
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#run-methods">Run Methods</a></li>
    <li><a href="#dependencies">Dependencies</a>
      <ul>
        <li><a href="#environment-setup">Environment Setup</a></li>
        <li><a href="#cluster-requirements">Cluster Requirements</a></li>
        <li><a href="#run-via-notebook">Run via Notebook</a></li>
        <li><a href="#run-via-main-class">Run via Main Class</a></li>
        <li><a href="#modules">Modules</a></li>
        <li><a href="#security-considerations">Security Considerations</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Getting Started
            </h1>
          

        


<h2 id="run-methods">Run Methods</h2>
<p>Overwatch is usually run via one of two methods:</p>
<ol>
<li>As a job controlling <a href="#run-via-notebook"><strong>running a notebook</strong></a></li>
<li>As a job running the <a href="#run-via-main-class"><strong>main class</strong></a> with the configs</li>
</ol>
<p>Below are instructions for both methods. The primary difference is the way by which the 
<a href="/userguide/configuration/">configuration</a> is implemented and the choice of which to use is
entirely user preference. Overwatch is meant to control itself from soup to nuts meaning it creates its own databases
and tables and manages all spark parameters and optimization requirements to operate efficiently. Beyond the config
and the job run setup, Overwatch runs best as a black box &ndash; enable it and forget about it.</p>
<h2 id="dependencies">Dependencies</h2>
<p>Add the following dependencies to your cluster</p>
<ul>
<li>scalaj &ndash; reliable API calls
<ul>
<li>Maven Coordinate: <code>org.scalaj:scalaj-http_2.11:2.4.2</code></li>
</ul>
</li>
<li>plotly &ndash; pretty reporting for some reports, whether or not you will need this depends on the reports you wish 
to run
<ul>
<li>Default PyPi - Tested with version 4.8.2</li>
</ul>
</li>
</ul>
<h3 id="environment-setup">Environment Setup</h3>
<p>There are some basic environment configuration steps that need to be enabled to allow Overwatch to do its job. 
These activities include things like 
<a href="https://docs.databricks.com/administration-guide/account-settings/audit-logs.html">enabling Audit Logs</a>, 
setting up security (as desired), etc. The setup activities
are slightly different depending on your cloud provider, currently Overwatch can operate on 
<a href="/environmentsetup/aws/"><strong>aws</strong></a> and <a href="/environmentsetup/azure/"><strong>azure</strong></a>. Please 
reference the page that&rsquo;s right for you.</p>
<h3 id="cluster-requirements">Cluster Requirements</h3>
<ul>
<li>DBR 6.4 - DBR 6.6
<ul>
<li>Spark 3 (DBR 7.x) has not yet been tested. Spark 3 implementation will be coming soon</li>
</ul>
</li>
<li>Add the relevant <a href="#dependencies">dependencies</a></li>
<li>Auto-scaling compute (Strongly Recommended)
<ul>
<li>Some of the modules paginate through API results which can take quite a bit of time and don&rsquo;t need a large 
number of worker nodes to progress whereas other modules require complex compute and having a larger cluster
will greatly speed up the job</li>
</ul>
</li>
<li>Auto-scaling Storage (Strongly Recommended)
<ul>
<li>Some of the data sources can grow to be quite large and require very large shuffle stages which requires
sufficient local disk. If you choose not to use auto-scaling storage be sure you provisions sufficient local
disk space.</li>
<li>SSD or NVME &ndash; It&rsquo;s strongly recommended to use fast local disks as there can be very large shuffles</li>
</ul>
</li>
</ul>
<h3 id="run-via-notebook">Run via Notebook</h3>
<p>Example Notebook (<a href="assets/GettingStarted/Runner_Job.html">HTML</a> / <a href="/assets/GettingStarted/Runner_Job.dbc">DBC</a>) &ndash; 
Create a notebook like the one referenced and substitute your 
<a href="/userguide/configuration/"><strong>configuration</strong></a> overrides.</p>
<ul>
<li><a href="#environment-setup">Setup The Environment</a> for your cloud provider</li>
<li>Create/Define cluster commensurate with the <a href="#cluster-requirements">Cluster Requirements</a></li>
<li>Notebook Basic Flow
<ul>
<li>Imports</li>
<li>Define Global Variables / Parameters (as needed)</li>
<li>Build the Config, the config is implemented through [&ldquo;OverwatchParams&rdquo;](TODO-LINKTO github class) case class</li>
<li>Initialize the Environment</li>
<li>Run Bronze &ndash;&gt; Silver &ndash;&gt; Gold Pipelines</li>
</ul>
</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scala" data-lang="scala"><span style="color:#66d9ef">val</span> db <span style="color:#66d9ef">=</span> dbutils<span style="color:#f92672">.</span>widgets<span style="color:#f92672">.</span>get<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dbName&#34;</span><span style="color:#f92672">)</span>

<span style="color:#66d9ef">import</span> com.databricks.labs.overwatch.pipeline.<span style="color:#f92672">{</span><span style="color:#a6e22e">Initializer</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">Bronze</span><span style="color:#f92672">,</span> <span style="color:#a6e22e">Silver</span><span style="color:#f92672">}</span>
<span style="color:#66d9ef">import</span> com.databricks.labs.overwatch.utils._

<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> dataTarget <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">DataTarget</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span>db<span style="color:#f92672">),</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#e6db74">s&#34;dbfs:/user/hive/warehouse/</span><span style="color:#e6db74">${</span>db<span style="color:#e6db74">}</span><span style="color:#e6db74">.db&#34;</span><span style="color:#f92672">))</span>
<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> tokenSecret <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">TokenSecret</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;databricks&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;overwatch_key&#34;</span><span style="color:#f92672">)</span>

<span style="color:#66d9ef">val</span> params <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">OverwatchParams</span><span style="color:#f92672">(</span>
  auditLogConfig <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">AuditLogConfig</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;s3a://auditLogBucketMount/audit-logs&#34;</span><span style="color:#f92672">)),</span>
  tokenSecret <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span>tokenSecret<span style="color:#f92672">),</span>
  dataTarget <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span>dataTarget<span style="color:#f92672">),</span> 
  badRecordsPath <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#e6db74">s&#34;/tmp/tomes/overwatch/sparkEventsBadrecords&#34;</span><span style="color:#f92672">),</span>
  overwatchScope <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Some</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;audit,accounts,sparkEvents,jobs,clusters,clusterEvents,notebooks&#34;</span><span style="color:#f92672">.</span>split<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;,&#34;</span><span style="color:#f92672">)),</span>
  maxDaysToLoad <span style="color:#66d9ef">=</span> <span style="color:#ae81ff">30</span>
<span style="color:#f92672">)</span>

<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> args <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">JsonUtils</span><span style="color:#f92672">.</span>objToJson<span style="color:#f92672">(</span>params<span style="color:#f92672">).</span>compactString
<span style="color:#66d9ef">val</span> workspace <span style="color:#66d9ef">=</span> <span style="color:#a6e22e">Initializer</span><span style="color:#f92672">(</span><span style="color:#a6e22e">Array</span><span style="color:#f92672">(</span>args<span style="color:#f92672">),</span> debugFlag <span style="color:#66d9ef">=</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>

<span style="color:#a6e22e">Bronze</span><span style="color:#f92672">(</span>workspace<span style="color:#f92672">).</span>run<span style="color:#f92672">()</span>
<span style="color:#a6e22e">Silver</span><span style="color:#f92672">(</span>workspace<span style="color:#f92672">).</span>run<span style="color:#f92672">()</span>
</code></pre></div><h3 id="run-via-main-class">Run via Main Class</h3>
<p>The Main class version does the same thing as the notebook version the difference is just how it&rsquo;s kicked off and 
configured. The tricky party about the main class is that the parameters must be passed in as a string argument in
string-escaped json. The &ldquo;OverwatchParams&rdquo; object gets jsonified and passed into the args of the Main Class. To 
simplify the creation of this string you can simply run the the exact same code as the 
<a href="#run-via-notebook">Notebook</a> runner <strong>EXCEPT</strong> don&rsquo;t run the Pipeline Runners (i.e. Bronze(workspace).run()).
Instead after the OverwatchParams class is instantiated, use the JsonUtils to output an escaped string.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scala" data-lang="scala"><span style="color:#66d9ef">val</span> params <span style="color:#66d9ef">=</span> <span style="color:#f92672">...</span>
<span style="color:#a6e22e">JsonUtils</span><span style="color:#f92672">.</span>objToJson<span style="color:#f92672">(</span>params<span style="color:#f92672">).</span>escapedString
</code></pre></div><p>This will output the string needed to be placed in the Main Class args. <!-- raw HTML omitted -->
Now that you have the string, setup the job. The Main Class for histoical batch is 
<code>com.databricks.labs.overwatch.BatchRunner</code><!-- raw HTML omitted -->

<div class="notices warning" ><p>TODO - These images must be anonymized</p>
</div>

<img src="/images/GettingStarted/job_params.png" alt="job_params"> <!-- raw HTML omitted -->
<img src="/images/GettingStarted/jarSetupExample.png" alt="jarSetupExample"></p>
<h3 id="modules">Modules</h3>
<p>Choosing which modules are right for your organization can seem a bit overwhelming, but for now it should be 
quite simple as several modules aren&rsquo;t yet released in this version. &ldquo;Modules&rdquo; are also sometimes 
referred to as &ldquo;Scope&rdquo;, know that the meaning is synonymous. To understand which modules are available in your
version and get more details on what&rsquo;s included, please refer to <a href="/userguide/modules/">Modules</a></p>
<h3 id="security-considerations">Security Considerations</h3>
<p>Overwatch will create a database that, by default, is accessible to everyone in your organization unless you
specify a location for the database in the configuration that is secured. Several of the modules capture fairly
sensitive data such as users, userIDs, etc. and the higher level data models (such as gold) make it simple for 
users to identify costs by user/group along with commonly access data sources for a specific user/group.</p>
<p>At present, Overwatch doesn&rsquo;t allow you 
to specify security configurations but simplified security setup is on the roadmap. For now, if you desire 
a database that is not accessible by all users, it&rsquo;s recommended to point the database target location to a 
specific bucket/storageAcct that&rsquo;s specifically for Overwatch. From there, the standard Databricks security
options can be employed to allow specific groups of users to access specific tables.</p>


<footer class="footline">
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/userguide/" title="UserGuide"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/userguide/configuration/" title="Configuration" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1603925781"></script>
    <script src="/js/perfect-scrollbar.min.js?1603925781"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1603925781"></script>
    <script src="/js/jquery.sticky.js?1603925781"></script>
    <script src="/js/featherlight.min.js?1603925781"></script>
    <script src="/js/highlight.pack.js?1603925781"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1603925781"></script>
    <script src="/js/learn.js?1603925781"></script>
    <script src="/js/hugo-learn.js?1603925781"></script>

    <link href="/mermaid/mermaid.css?1603925781" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1603925781"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

